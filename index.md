<a href="https://github.com/intbio/mol_model_course_2023/blob/main/index.md"><img style="position: absolute; top: 0; right: 0; border: 0;" src="gitimg.png" alt="To GitHub"></a>
# Molecular Modeling and Simulations for Biologists (Spring 2023)

### Contact information
- Instructor: Alexey K. Shaytan, PHD alex@intbio.org
- Teaching assistant: 
- [Telegram link](https://t.me/+qX_eshjQCoM3MzIy)
- [Folder with presentations](https://www.dropbox.com/sh/a82al5mfcbhi7co/AABpd8zZAEjnrCIniMBhxK2Wa?dl=0)
- [BBB link](https://distant.bioeng.ru/b/gvv-7mb-rdi-zv2)
- [Home work folder](https://www.dropbox.com/request/FwV8ZjdKGk5xQecatCjj)

### Meetings and Location
- Classroom: Bioeng Dept. (Leninskie Gory 1-73), rooms 542, 543
- Lectures: Fridays 12:45-14:15
- Seminars: 14:50 - 16:20


### Credits
2 credits, 72 academic hours

### Course Description
The course provides an overview of molecular modeling and simulations methods in biology with an emphasis on 3D modeling of biomolecular structures. Covered topics include: viewing and anlyzing PDB structures, structural bioinformatics, molecular dynamics simulations, Monte-Carlo simulations, coarse-grained modeling, molecular screening, docking, model building from experimental data, integrative modeling, quantum chemistry calculations, protein structure prediction.  The course include both lectures, hands-on exercises and home assignments.  

### Learning objectives
- To understand:
     - the principle of molecular modeling techniques in biology.
     - the spectrum of molecular modeling and simulations methods and their applicability.
     - the relation between the experimental data and structural models. 
- To be able to:
     - vizualize and analyze PDB-structure files.
     - run basic MD simulations.
     - do comparative protein modeling and use protein structure prediction tools.
     - Run basic docking simulations.
     - Run basic quantum chemistry simulations.

 
### Textbooks and learning resources
- H.-D. Höltje et al. Molecular Modeling: Basic Principles and Applications, 3rd Edition [English](https://www.wiley.com/en-us/Molecular+Modeling%3A+Basic+Principles+and+Applications%2C+3rd+Edition-p-9783527315680), [Russian](https://www.ozon.ru/context/detail/id/19483913/)
- J. Gu, Ph. Bourne. Structural Bioinformatics, 2nd Edition [English](https://www.wiley.com/en-us/Structural+Bioinformatics%2C+2nd+Edition-p-9780470181058)
- D.C. Young Computational Chemistry: A Practical Guide for Applying Techniques to Real World Problems [Link](https://onlinelibrary.wiley.com/doi/book/10.1002/0471220655)
-  D. Frenkel, B. Smit Understanding Molecular Simulation: From Algorithms to Applications, 2nd Edition [Link](https://www.elsevier.com/books/understanding-molecular-simulation/frenkel/978-0-12-267351-1)
- B. Rupp "Biomolecular Crystallography: Principles, Practice, and Application to Structural Biology" [Link](http://www.ruppweb.org/Garland/default.htm)
- J. Rigden "From Protein Structure to Function with Bioinformatics" [English](https://www.springer.com/gp/book/9789048180585), [Russian](https://urss.ru/cgi-bin/db.pl?lang=Ru&blang=ru&page=Book&id=180705)
- A.R. Khokhlov, A.L. Rabinovich, V.A. Ivanov. Computer modeling methods in polymer and biopolymer research.  [Russian only](http://urss.ru/cgi-bin/db.pl?lang=Ru&blang=ru&page=Book&id=106880)
- K.V. Shaitan, K.B. Tereshkina. Molecular dynamics simulations of proteins and peptides. [Russian only](https://istina.msu.ru/publications/book/10136512/)
- [Gromacs manual](https://manual.gromacs.org)


### Required resources
 1. Laptop or workstation with access to internet.
 2. Web-cam in case of distant learning.
 2. An account on Newton Server https://newton.bioeng.ru See instructions [here](https://github.com/intbio/IT_notes/blob/master/newton_cheatsheet.md).
 3. [Pymol](https://pymol.org/2/) installed locally on your workstation/laptop.
 4. [UCSF Chimera](https://www.cgl.ucsf.edu/chimera/) installed locally on your workstation/laptop.
 5. [VMD](https://www.ks.uiuc.edu/Research/vmd/) installed locally on your workstation/laptop.
 6. [Avogadro](https://avogadro.cc) installed locally on your workstation/laptop.

### Course calendar
- Dates: 2/10/2023; 2/17/2023 ; 3/3/2023 ; 3/10/2023 ; 3/17/2021 ; 3/24/2023 ; 3/31/2023 ; 4/7/2023 ; ?4/14/2023 ; ?4/21/2023 ; 4/28/2023 ; 5/5/2023 ; 5/12/2023; ; 5/19/2023 

### Attendance policy
- 100% attendance is required
- For every missed lecture a paper no less than 1500 words is required explaining the lecture contents.
- For every missed seminar a written protocol or a screen cast showing that the student has succesfully done all hands-on excercises is required. 

### Assignments policy
- Assignments are due in two weeks.
- Assignments should be uploaded via [this link](https://www.dropbox.com/request/FwV8ZjdKGk5xQecatCjj) in one file (doc, pdf, zip). The name of the file is as follows: Asgmt_Number_Surname_Initials. E.g. Asgmt_2_Petrov_AV.pdf
- Assignments are graded on a 100 point scale
- Late policy: 10 points are deducted for week the assignment is late. 

### Course program (in Russian)

#### Модуль 1. Introduction and orientation (1 неделя)
<details><summary><ins>Лекция 1</ins> Вводная лекция. История и виды методов моделирования.</summary> Понятия молекулярного моделирования, имитационного моделирования, интегративного моделирования. История развития методов молекулярной динамики, методов Монте-Карло. Подходы к созданию моделей структур по экспериментальным данным. Различные методы и границы их применимости. Понятия ab initio и in silico. Современные пакеты для молекулярного моделирования. Современные пакеты для визуализации PDB структур. Суперкомпьютеры в молекулярном моделировании.

<a href="https://www.dropbox.com/s/ze44ogvkgz4w1uc/Lecture1.ppt?dl=0">Слайды лекции.</a> 
<a href="https://distant.bioeng.ru/playback/presentation/2.0/playback.html?meetingId=4578ef0cf123b710b7e95fdbfa8fbcc844ec6bc3-1612787489424">Запись лекции.</a> 
<br>

</details>
     
<details><summary><ins>Семинар 1</ins> Использование ЭВМ и доступ к ним, установка, настройка программ и сред </summary> Использование ОС Линукс, подключение к вычислительному кластеру, SSH, X2GO, установка и компиляция программ. Использование репозиториев, GitHub. Установка и использование программ визуализации структур.
     
- <a href="https://intbio.org/mol_model_course_2023/workshops/workshop1"> Протокол семинара </a>
     
</details>

<details><summary><ins>Самостоятельная работа 1</ins></summary> 
 см. протокол семинара
     
</details>

<details><summary><ins>Required reading</ins></summary>
     
- <a href="https://www.dropbox.com/s/vlkpzaiz0twzlsl/mol_model_history.pdf?dl=0">Методы молекулярного и интегративного моделирования в структурной биологии</a>
</details>

<details><summary><ins>Suggested reading</ins></summary>
- <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5980623/">John Kendrew and myoglobin: Protein structure determination in the 1950s</a><br>
- <a href="https://febs.onlinelibrary.wiley.com/doi/full/10.1111/febs.12796">A brief history of macromolecular crystallography, illustrated by a family tree and its Nobel fruits</a><br>
- <a href="https://library.lanl.gov/cgi-bin/getfile?00326866.pdf">Metropolis, N. The Beginnig of the Monte Carlo Method</a><br>
- <a href="https://www.dropbox.com/s/cnvazv8n78ximdp/%D0%A8%D0%BD%D0%BE%D0%BB%D1%8C%D0%AD%D0%AD-%D0%93%D1%80%D0%B8%D0%B2%D1%86%D0%BE%D0%B2_%D0%9C%D0%94-%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D0%BE.pdf?dl=0">Э.Э. Шноль. "А.Г. Гривцов и молекулярная динамика - начало"</a><br>
- <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3820920/#__sec1title">An Introduction to Biological NMR Spectroscopy</a><br>
</details>

#### Модуль 2. Структурная биоинформатика (2 недели).
<details><summary><ins>Лекция 2</ins></summary> Форматы хранения информации о структуре молекул (PDB, mmCIF, mol2, Z-матрицы и др.). Формат PDB, поля формата. Происхождение структурной информации, основные экспериментальные методы, представление данных. Элементарная ячейка кристалла, асиметричная единица, понятие BioAssembly, кристаллографическая и некристаллографическая симметрии структур. PDB: B-факторы, occupancy. PDB: специфика ЯМР структур. Правила описания белков, нуклеиновых кислот, липидов, лигандов. Тяжелоатомные и протонированные модели. Протонирование моделей. Базы данных структур. Базы PDB, NDB, MMDB, CCDC, EMDB. Поиск в базах данных, поиск по последовательности и по структуре. Форматы записи электронной плотности. Типичные проблемы в структурах, ротамеры боковых цепей. Определение качества PDB структур. Программы анализа качества структур. 


<a href="https://www.dropbox.com/s/lh6w1280fghwxnc/Lecture2.ppt?dl=0">Слайды лекции.</a> 
</details>
<details><summary><ins>Required reading</ins></summary>
  - <a href="https://pdb101.rcsb.org/learn/guide-to-understanding-pdb-data/introduction">Introduction to PDB Data</a>
 </details>
 
<details><summary><ins>Suggested reading</ins></summary>
 - <a href="ftp://ftp.wwpdb.org/pub/pdb/doc/format_descriptions/Format_v33_A4.pdf">PDB format description</a>
</details>

     
<details><summary><ins>Семинар 2</ins> Визуализация 3D-структур.</summary> Обзор различных программ (Pymol, Chimera, VMD, Maestro, CND3D, Coot). Программа Pymol. Загрузка структур. Выделение цепей, фрагментов последовательности. Различные представления. Построение поверхностей. Наложение структур. Протонирование моделей. Создание видео. Визуализация конформационных перестроек. Раскраска структуры по B-фактору и другим параметрам. Сравнение структуры с электронной плотностью.  Автоматизация в виде скриптов.

<br>
<a href="workshops/pymol">Описание и протокол семинара.</a>
</details>

<details><summary><ins>Самостоятельная работа 2</ins></summary> 
см. описание семинара
</details>

<details><summary><ins>Лекция 3</ins> Анализ и сравнительный анализ 3D-структур.</summary> Виды визуализации структур, стерео-представление, ray-tracing. Определение вторичной структуры. Карты Рамачандрана.  Поверхность доступная растворителю. Водородные связи. Карты контактов. Структурные выравнивания и среднеквадратичное отклонение. Идентификация структурных доменов. Базы данных CDD и PFAM. Структурная классификация доменов (SCOP, CATH). Идентификация полостей и сайтов связывания. Электростатический и гидрофобный потенциалы. Определение состояний протонирования. Анализ симметрии. Анализ динамики, нормальные моды. Оценка свободной энергии сворачивания. Определение мультимеров.

<a href="https://www.dropbox.com/s/t93ok6dovz55j8a/Lecture3.ppt?dl=0">Слайды лекции.</a> 
</details>
     
<details><summary><ins>Семинар 3.1-3.2</ins> Анализ и сравнительный анализ 3D-структур.</summary> 
Работа с библиотекой MDAnalysis. Расчет растояний, углов, контактов. Расчет RMSD. Стркутурное выравнивание. Работа в программе Chimera. Структурные выранивания, струкутрное выравнивание последовательностей. Добавление водородов, программа REDUCE. Добавление зарядов, PDB2PQR. Рассчет pK, PROPKA. Расчет электростатического потенциала, APBS. Поиск водородных связей. Библиотека Prody. Анализ нормальных мод. Поиск родственных структур, определение консервативных остатков, визуализация.
<br>
<a href="workshops/3Dstruct_analysis">Протокол семинара.</a>
</details>

<details><summary><ins>Самостоятельная работа 3.1-3.2</ins></summary> 
см. описание семинара
</details>
<details><summary><ins>Suggested reading</ins></summary>
 - <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC208735/">D. Eisenberg, The discovery of the α-helix and β-sheet, the principal structural features of proteins</a>
 -  <a href="https://www.sciencedirect.com/science/article/abs/pii/S0065323308605203">J.S. Richardson, The Anatomy and Taxonomy of Protein Structure</a>
</details>


#### Модуль 3. Методы молекулярной механики и динамики (4 недели).

<details><summary><ins>Лекция 4</ins> Теоретические основы методов молекулярной механики и динамики. Задание моделей молекул. </summary> Молекулярно-механические модели, границы применимости. Основы классической механики: материальные точки, законы Ньютона, силы, энергия, Гамильтониан, обобщенные переменные, координаты реакции. Методы минимизации энергии. Уравнения движения. Траектории движения частиц, фазовое пространство. Численные подходы к решению уравнений движения. Алгоритмы Эйлера, Верле, Лип-Фрог. Неустойчивость траектроий и хаос. Обратимость по времени уравнений движения.  Типы взаимодействий в молекулярных системах.  Понятие силового поля и топологии молекулы. Единицы длины, времени, энергии. Основные типы взаимодействий: валентные, невалентные взаимодействия, связи, валентные, торсионные, ложноторсионные углы, потенциал Леннард-Джонса, заряды. Проблема учета электростатических взаимодействий. Силовые поля класса II. Поляризуемые силовые поля. Модели воды. Неявный растворитель. Основы статистической физики: распределение Больцмана-Гиббса, понятие энтропии, второй закон термодинамики. Парадокс обратимости. Гипотеза эргодичности. Понятие термодинамического ансамбля. Понятие свободной энергии, работы. Профили свободной энергии, потенциал средней силы. Неравновесные процессы. Равенство Джарзинского. 

<a href="https://www.dropbox.com/s/xl9scwmnn0hd6gy/Lecture4.ppt?dl=0">Слайды лекции.</a> 
</details>
     
<details><summary><ins>Семинар 4</ins> Подготовка и запуск МД расчетов в Gromacs</summary> 
<a href="workshops/MD2_simul">Протокол семинара.</a>
</details>

<details><summary><ins>Самостоятельная работа 4</ins></summary> 
см. описание семинара
</details>


<details><summary><ins>Лекция 5</ins> Алгоритмы и методы молекулярной динамики.</summary> Общая схема постановки молекулярно-динамического расчета. Подготовка, минимизация и релакасация системы. Выбор шага интегрирования. Периодические граничные условия. Радиусы обрезания. Суммы Эвальда и методы учета электростатических взаимодействий. Списки соседей. Ограничения на длины связей. Термостатирование и баростатирование системы. Броуновская динамика, динамика Ланжевена. Параллельные вычисления. Декомпозиция области. Суперкомпьютерные параллельные технологии в молекулярном моделировании. Использование графических процессоров.

<a href="https://www.dropbox.com/s/ef728toz7myzf06/Lecture5.ppt?dl=0">Слайды лекции.</a> 
</details>
     
<details><summary><ins>Семинар 5</ins> Анализ расчетов в MDAnalysis.</summary> 
<a href="workshops/MD3_analysis">Протокол семинара.</a>
</details>

<details><summary><ins>Самостоятельная работа 5</ins></summary> 
см. описание семинара
</details>


<details><summary><ins>Лекция 6</ins> Дизайн и анализ молекулярно-динамических экспериментов.</summary> Выбор стартового состояния. Выбор набора систем для сравнительного моделирования. Выбор силового поля. Выбор времени моделирования и количества моделирумых систем. Методы работы с траекториями. Выход на равновесие. Иерархия динамических веремен. Анализ средних, флуктуаций, статистической достоверности. Автокорреляционные функции. Связь корреляции и диффузии. Энтальпия взаимодействия, теплоемкость. Функции радиального распределения. Анализ RMSD, d-RMSD. Кластерный анализ. Сетевой анализ. Анализ на основе марковских моделей. Добавление внешних воздействий. Примеры результатов моделирования различных систем (фолдинг белков, диффузия лигандов в белках, биомембраны, ионные каналы, ДНК-белковые комплексы). Транспортные коэффициенты. Анализ главных компонент. Методы понижения размерности. Применение нейросетей. 
<a href="https://www.dropbox.com/s/bt58dd8th5ffse7/Lecture6.ppt?dl=0">Слайды лекции.</a> 
</details>
     
<details><summary><ins>Семинар 6</ins> Анализ расчетов в MDAnalysis (Практика).</summary> 
<a href="workshops/MD_3_2_analysis">Протокол семинара.</a>
</details>

<details><summary><ins>Самостоятельная работа 6</ins></summary> 
см. описание семинара
</details>


<details><summary><ins>Лекция 7</ins> Методы Монте-Карло. Вариации методов МД.</summary> Методы Монте-Карло. Методы марковских цепей Монте-Карло (Markov chain Monte-Carlo). Критерий Метрополиса-Хастингса. Методы улучшения возмжоностей статистических выборок (enhanced sampling techniques). Вычислительный отжиг (simulated annealing). Методы обмена репликами (Replica Exchange, Parallel tempering.). Метод зонтичной выборки (umbrella sampling, WHAM).  Метод адаптивной семщающей силы (ABF, adaptive biasing force). Различные виды коллективных переменных. Метод управляемой МД (steered MD). Адиабатически смещенная МД (adiabatic bias MD). Метод метадинамики. Метод ускоренной МД (accelerated MD). Методы расчета свободной энергии. Примеры оценки термодинамических параметров и профилей свободной энергии. Огрубленное моделирование. Мультимасштабное моделирование.
<a href="https://www.dropbox.com/s/hzqcsfq87lanxr6/lecture7.ppt?dl=0">Слайды лекции.</a>
</details>
     
<details><summary><ins>Семинар 7</ins> Using PLUMED for enhanced sampling.</summary> 
<a href="workshops/MD4_PLUMED">Протокол семинара.</a>
</details>

<details><summary><ins>Самостоятельная работа 7</ins></summary> 
см. описание семинара
</details>


#### Модуль 4. Предсказание и дизайн структуры белков (2 недели).

<details><summary><ins>Лекция 8</ins> Методы предсказания структры белков.</summary> Моделирование по гомологии. Создание выравнивания. Оценка качества модели. Детекция фолда. Протягивание. Скрытые марковские модели. Нейросети. Физические методы моделирования и предсказания.
<a href="https://www.dropbox.com/s/3qiewrq9ahzczcw/Lecture8-9.ppt?dl=0">Слайды лекции.</a> <a href="https://example.com">Видеозапись.</a>
</details>
     
<details><summary><ins>Семинар 8</ins> Знакомство с программами Modeller и AlphaFold.</summary> Знакомство с программой Modeller. Построение структурных моделей по гомологии с с известными структурами.  
<a href="workshops/Modeller">Протокол семинара.</a>
</details>

<details><summary><ins>Самостоятельная работа 8</ins></summary> 
см. описание семинара
</details>


<details><summary><ins>Лекция 9. </ins> Методы дизайна структуры белков.</summary> Физические принципы организации белков. Водородные связи, гидрофобные взаимодействия, взаимодействия ароматических аминокислот. Понятие воронки фолдинга, парадокс Левинталя, расплавленная глобула. Однодоменные и многодоменные белки. Эмпирические функции свободной энергии белков. Создание мутантных белков, термостабильных белков. Предсказание влияния аминокислотных замен. De novo дизайн белков. Подходы к оптимизации структуры. Мультимасштабные подходы. Пример подходов в программе Rosetta. Примеры искусственно созданных белков.

<a href="https://www.dropbox.com/s/3qiewrq9ahzczcw/Lecture8-9.ppt?dl=0">Слайды лекции.</a>
</details>
     
<details><summary><ins>Семинар 9</ins> Знакомство с программой Rossetta.</summary> 
<a href="workshops/Rosetta">Протокол семинара.</a>
</details>

<details><summary><ins>Самостоятельная работа 9</ins></summary> 
см. описание семинара
</details>


#### Модуль 5. Виртуальный скрининг и докинг (1 неделя).

<details><summary><ins>Лекция 10</ins> Методы виртуального скирининга и докинга.</summary> Медицинская химия и рациональный дизайн лекарств. Хиты и лидерные соединения. Хранение информации о химических соединениях. Меры сходства химических соединений. Коэффициент Танимото. Базы данных химических соединений. Понятие о QSAR методах, расчеты ADMET cвойств. Виды виртуального скрининга. Фармакофоры и фармакофорный поиск. Молекулярный докинг: общая постановка задачи, определения и основные подходы. Учёт конформационной подвижности лиганда и рецептора. Алгоритмы поиска поз. Межмолекулярные взаимодействия и функции оценки энергии связывания. Использование молекулярного докинга для аннотации функции белка. Макромолекулярный докинг - его отличия от докинга низкомолекулярных соединений. Белок-пептидный докинг. Примеры программ и веб-сервисов для выполнения молекулярного докинга.
 

<a href="https://www.dropbox.com/s/1g3ousqqqzwctz9/Lecture10.ppt?dl=0">Слайды лекции.</a>
<a href="https://www.dropbox.com/s/ipc5tiewmmfal29/2021_lecture_Virtual_Screening_and_Molecular_Docking.pdf?dl=0">Слайды лекции. В.Н. Новоселецкого 2021 год</a>
</details>
     
<details><summary><ins>Семинар 10</ins> Знакомство с программами SwissDock и AutoDock Vina</summary> 
<a href="workshops/Docking">Протокол семинара.</a>
</details>

<details><summary><ins>Самостоятельная работа 10</ins></summary> 
см. описание семинара
</details>


#### Модуль 6. Принципы квантовых расчетов (1 неделя).


<details><summary><ins>Лекция 11</ins> Основы квантово-химических расчетов.</summary> Квантовая механика. Стационарное уравнение Шредингера для электрона. Волновые функции. Орбитали атома водорода. Приближение Борна-Оппенгеймера. Спин. Фермионы и принцип Паули. Ab initio подходы. Метод Хартри-Фока. ЛКАО. Молекулярные орбитали. 
Базисы и базисные функции. Методы учета корреляций электронов. Полуэмпирические методы. Теория функционала плотности (DFT). DFT функционалы и базисы. Методы расчета возбужденных состояний и спектральных характеристик. Методы расчета переноса заряда, теория Маркуса. Методы КМ/ММ. Квантовая МД. Методы расчета парциальных зарядов, заряды по Малликену, RESP. Методы расчета торсионных потенциалов. Программы![image](https://user-images.githubusercontent.com/397204/118412488-f7021c80-b6a2-11eb-8d53-11ce5b3f3b86.png)

<a href="https://www.dropbox.com/s/f1urrwbyg2j73ec/Lecture10.ppt?dl=0">Слайды лекции.</a> 
</details>
     
<details><summary><ins>Семинар 11</ins> Знакомство с программой NWCHEM</summary> 
<a href="workshops/NWChem">Протокол семинара.</a>
</details>

<details><summary><ins>Самостоятельная работа 11</ins></summary> 
см. описание семинара
</details>

<!-- <details><summary><ins>Лекция 12</ins> Различные подходы.</summary> Методы функционала плотности (DFT). Методы расчета спектральных характеристик. Моделирование химических реакций. Моделирование переноса заряда. Методы КМ/ММ.
<a href="https://example.com">Слайды лекции.</a> <a href="https://example.com">Видеозапись.</a>
</details> -->
     
<!--<details><summary><ins>Семинар 12</ins> Работа с программой NWCHEM</summary> 
<a href="https://example.com">Протокол семинара.</a>
</details>-->

<!--<details><summary><ins>Самостоятельная работа 12</ins></summary> 
ЗДЕСЬ БУДУТ ДЕТАЛИ ЗАДАНИЯ
</details> -->


### Assessments

#### Criteria
- Assignments - 35%
- Final exam - 65%

#### Grades
- Excellent: > 90%
- Good: 70-90%
- Satisfactory: 50%-70%
- Fail: <50%

 

